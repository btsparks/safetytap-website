---
import Base from '../../layouts/Base.astro';
import BlogCard from '../../components/BlogCard.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<!-- Step 1: Meta — title 55 chars, description 144 chars — primary keywords in both -->
<Base
  title="Insights"
  metaTitle="Hazard Recognition Research & Insights | SafetyTAP"
  description="Research-backed articles on how workers develop hazard recognition, why safety programs fail, and what actually changes behavior on the job site."
>
  <section class="max-w-3xl mx-auto px-6 py-16 md:py-24">
    <p class="text-sm font-semibold tracking-widest uppercase text-teal mb-3">Latest Insights</p>
    <h1 class="font-display text-3xl md:text-4xl font-bold text-navy tracking-tight">The Science of Seeing</h1>
    <p class="text-dark/60 mt-2 text-base leading-relaxed">Research-backed insights on hazard recognition, safety psychology, and building competence in the field.</p>
    <div class="mt-12 space-y-8">
      {posts.length > 0 ? (
        posts.map((post) => (
          <BlogCard
            title={post.data.title}
            description={post.data.description}
            date={post.data.date}
            readTime={post.data.readTime}
            slug={post.slug}
            tags={post.data.tags}
          />
        ))
      ) : (
        <p class="text-dark/50">Posts coming soon.</p>
      )}
    </div>
  </section>
</Base>
